#include <iostream>
#include <windows.h>
#include <string>
#include <algorithm>

using namespace std;

#pragma region Print

enum ConsoleColor
{
    black = 0,
    blue = 1,
    green = 2,
    cyan = 3,
    red = 4,
    magenta = 5,
    brown = 6,
    lightGray = 7,
    darkGray = 8,
    lightBlue = 9,
    lightGreen = 10,
    lightCyan = 11,
    lightRed = 12,
    lightMagenta = 13,
    yellow = 14,
    white = 15
};

string str_tolower(string s)
{
    transform(s.begin(), s.end(), s.begin(),
        [](unsigned char c) { return tolower(c); });
    return s;
}
void print(string text = " ", int x = 0, int y = 0, ConsoleColor text_color = white, ConsoleColor background = black)
{
    HANDLE handle;
    COORD coordinates;
    handle = GetStdHandle(STD_OUTPUT_HANDLE);
    coordinates.X = x;
    coordinates.Y = y;
    SetConsoleCursorPosition(handle, coordinates);
    SetConsoleTextAttribute(handle, (WORD)((background << 4) | text_color));
    cout << text;

}
void print(int x = 0, int y = 0, ConsoleColor background = black)
{
    print(" ", x, y, background, background);
}
#pragma endregion Print


void box(int x, int y, int width, int height, ConsoleColor color)
{
    for (size_t i = y; i < y + height; i++)
    {
        for (size_t j = x; j < x + width; j++)
        {
            print(j, i, color);
        }
    }
}
string anim_roulet(string cells[]) {
    string res;
    for (size_t i = 1; i < 30; i++)
    {
        int rnd = rand() % 37;
        int s = 1;
        if (rnd < 10) s = 2;
        if (cells[rnd][2] == 'b')
        {
            box(10, 14, 5, 3, black);
            print(to_string(rnd), 10 + s, 14 + 1, white, black);
        }
        if (cells[rnd][2] == 'r')
        {
            box(10, 14, 5, 3, red);
            print(to_string(rnd), 10 + s, 14 + 1, white, red);
        }
        if (cells[rnd][2] == 'z')
        {
            box(10, 14, 5, 3, green);
            print(to_string(rnd), 10 + s, 14 + 1, white, green);
        }
        Sleep(10 * i);
        res = cells[rnd];
    }
    return res;
}

int main()
{
    setlocale(0, "");
#pragma region Arrays
    int circle[][2] = {
        {11,9},
        {12,9},
        {13,9},
        {14,10},
        {15,10},
        {16,10},
        {17,11},
        {18,12},
        {18,13},
        {19,14},
        {19,15},
        {19,16},

        {18,17},

        {18,18},
        {17,19},

        {16,20},
        {15,20},
        {14,20},

        {13,21},
        {12,21},
        {11,21},
        {10,20},
        {9,20},
        {8,20},
        {6,18},

        {7,19},
        {6,17},

        {5,14},
        {5,15},
        {5,16},

        {6,13},
        {6,12},

        {7,11},
        {8,10},
        {9,10},
        {10,10}
    };
    string cells[] = { "00z","01r","02b","03r","04b","05r","06b", "07r", "08b","09r","10b", "11b","12r","13b", "14r", "15b","16r","17b","18r","19r","20b","21r","22b","23r","24b","25r","26b","27r","28b","29b","30r","31b","32r","33b","34r","35b","36r" };
#pragma endregion Arrays


#pragma region Draw
    for (size_t i = 0; i < 40; i++)
    {
        for (size_t j = 0; j < 100; j++)
        {
            print(j, i, lightGreen);
        }
    }
    
    for (size_t i = 10; i < 10 + 11; i++)
    {
        for (size_t j = 8; j < 8 + 9; j++)
        {
            print(j, i, brown);
        }
    }
    for (size_t i = 12; i < 12 + 7; i++)
    {
        for (size_t j = 6; j < 6 + 13; j++)
        {
            print(j, i, brown);
        }
    }

    for (size_t i = 0; i < size(circle); i++)
    {
        print(circle[i][0], circle[i][1], black);
    }


    box(30, 5, 67, 23, darkGray);
    box(30, 28, 67, 1, brown);
    box(31, 6, 5, 9, green);
    print("0", 33, 10, white, green);
    for (size_t j = 36, k = 1; j < 12 * 5 + 36; j += 5)
    {
        for (size_t i = 3 + 9; i > 3; i -= 3, k++)
        {
            int num = stoi(cells[k].substr(0, 2));
            int s = 1;
            if (num < 10) s = 2;
            if (cells[k][2] == 'r')
            {
                box(j, i, 5, 3, red);
                print(to_string(num), j+s, i+1, white, red);
            }
            if (cells[k][2] == 'b')
            {
                box(j, i, 5, 3, black);
                print(to_string(num), j+s, i+1, white, black);
            } 
        }
    }
    box(37, 16, 18, 5, lightGray);
    print("1 ST 12", 42, 18, black, lightGray);

    box(57, 16, 18, 5, lightGray);
    print("2 ND 12", 62, 18, black, lightGray);

    box(77, 16, 18, 5, lightGray);
    print("3 RD 12", 82, 18, black, lightGray);

    box(37, 22, 9, 5, lightGray);
    print("1 TO 18", 38, 24, black, lightGray);

    box(47, 22, 8, 5, lightGray);
    print("EVEN", 49, 24, black, lightGray);

    box(57, 22, 8, 5, red);
    print(" RED ", 58, 24, white, red);

    box(66, 22, 9, 5, black);
    print("BLACK", 68, 24, white, black);

    box(77, 22, 9, 5, lightGray);
    print("ODD", 80, 24, black, lightGray);

    box(87, 22, 8, 5, lightGray);
    print("19 TO 36", 87, 24, black, lightGray);

    box(32, 18, 3, 3, lightRed);
    box(32, 18, 3, 2, lightMagenta);
    box(32, 18, 3, 1, magenta);

    box(32, 22, 3, 3, lightBlue);
    box(32, 22, 3, 2, lightMagenta);
    box(32, 22, 3, 1, magenta);
#pragma endregion Draw

#pragma region Game
    srand(time(NULL));
    int money = 10000;
    string bet;
    int bet_money;
    string set;

    while (money > 0) {
        print("                           ", 30, 30, lightGreen, lightGreen);
        print("Money: " + to_string(money) + "$", 30, 30, white, black);
        print("Bet $       ", 30, 32, white, black);
        print("Set         ", 30, 34, white, black);
        print(" ", 36, 32, white, black);
        getline(cin, bet);
        try
        {
            bet_money = stoi(bet);
        }
        catch (exception ex)
        {
            return 1;
        }
        print(" ", 36, 34, white, black);
        getline(cin, set);
        money -= bet_money;
        print("                           ", 30, 30, lightGreen, lightGreen);
        print("Money: " + to_string(money) + "$", 30, 30, white, black);
        string res = anim_roulet(cells);
        int num_set;
        try {
            num_set = stoi(set);
            if (stoi(res.substr(0, 2)) == num_set) {
                money += bet_money * 36;
            }
        }
        catch (exception ex)
        {
            if (str_tolower(set) == "red" && res[2] == 'r') {
                money += bet_money * 2;
            }
            if (str_tolower(set) == "black" && res[2] == 'b') {
                money += bet_money * 2;
            }
        }
    }
    print("                           ", 30, 30, lightGreen, lightGreen);
    print("GAME OVER", 30, 30, white, black);


#pragma endregion Game
    int x;
    cin >> x;
}
